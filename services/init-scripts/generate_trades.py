#!/usr/bin/env python3
"""Generate 100 trades with corrected spelling and randomized dates"""
import random
from datetime import datetime, timedelta

# Raw data with FIRELNK â†’ FIRELINK fixed
trades_raw = """
69269882	ACC084	FX	HIGHGARDEN	TRAI	LCH	2025-01-06 01:33:00	2025-09-17 06:13:41	CANCELLED
48712564	ACC054	CDS	KINGSLANDING	MARC	CME	2025-05-04 09:45:44	2025-09-22 21:34:55	ALLEGED
54146216	ACC071	CDS	WINTERFELL	FIRELINK	OTCCHK	2025-02-05 03:01:52	2025-08-10 14:53:23	ALLEGED
67515456	ACC046	CDS	KINGSLANDING	BLM	CME	2025-04-03 02:22:13	2025-09-20 19:30:02	ALLEGED
69755320	ACC045	CDS	WINTERFELL	FIRELINK	LCH	2025-06-09 04:32:02	2025-09-07 08:09:03	ALLEGED
77194044	ACC040	IRS	KINGSLANDING	MARC	LCH	2025-06-20 11:44:53	2025-08-19 19:46:50	REJECTED
60724962	ACC023	IRS	RED KEEP	BLM	OTCCHK	2025-06-11 02:27:23	2025-10-19 12:18:51	REJECTED
96904486	ACC081	CDS	WINTERFELL	MARC	OTCCHK	2025-04-06 03:53:48	2025-10-08 00:29:04	CANCELLED
14355627	ACC011	FX	RED KEEP	MARC	JSCC	2025-05-30 08:01:26	2025-10-22 12:25:41	ALLEGED
42511774	ACC001	IRS	RED KEEP	MARC	CME	2025-02-19 14:21:49	2025-08-24 05:16:20	REJECTED
72427554	ACC019	FX	KINGSLANDING	FIRELINK	OTCCHK	2025-01-29 18:09:08	2025-10-15 18:00:51	CANCELLED
81930671	ACC031	FX	WINTERFELL	BLM	OTCCHK	2025-06-21 15:49:46	2025-09-08 05:35:16	CANCELLED
88531321	ACC074	IRS	WINTERFELL	BLM	LCH	2025-02-22 18:10:17	2025-09-11 18:16:40	CANCELLED
56535550	ACC034	IRS	KINGSLANDING	TRAI	OTCCHK	2025-06-28 20:24:44	2025-09-20 17:32:04	CANCELLED
66663488	ACC091	FX	WINTERFELL	FIRELINK	JSCC	2025-04-09 08:41:20	2025-09-06 20:32:37	CANCELLED
64737734	ACC005	IRS	RED KEEP	TRAI	CME	2025-07-11 20:34:21	2025-09-14 16:15:46	ALLEGED
49964172	ACC077	FX	HIGHGARDEN	TRAI	OTCCHK	2025-02-25 16:56:47	2025-10-18 03:42:27	ALLEGED
73001300	ACC078	CDS	RED KEEP	BLM	LCH	2025-02-25 09:38:52	2025-10-06 01:32:20	CANCELLED
27625806	ACC013	FX	KINGSLANDING	FIRELINK	CME	2025-02-06 07:32:56	2025-09-05 07:48:44	CANCELLED
98159040	ACC032	CDS	HIGHGARDEN	FIRELINK	JSCC	2025-01-26 00:10:59	2025-09-19 04:19:48	CLEARED
86836834	ACC056	CDS	KINGSLANDING	MARC	JSCC	2025-03-06 02:30:51	2025-09-21 13:53:27	REJECTED
51883413	ACC089	CDS	HIGHGARDEN	MARC	LCH	2025-06-27 14:42:57	2025-10-25 02:58:14	CANCELLED
15706882	ACC027	IRS	HIGHGARDEN	TRAI	CME	2025-05-02 05:36:03	2025-10-21 00:10:47	CLEARED
77186642	ACC043	CDS	KINGSLANDING	BLM	LCH	2025-05-06 10:22:19	2025-09-17 05:19:29	REJECTED
87472545	ACC070	CDS	HIGHGARDEN	FIRELINK	LCH	2025-04-08 13:29:00	2025-08-09 06:52:13	ALLEGED
61270683	ACC016	FX	RED KEEP	BLM	LCH	2025-02-07 15:19:09	2025-09-04 05:41:21	REJECTED
84171052	ACC041	FX	KINGSLANDING	FIRELINK	JSCC	2025-06-20 13:12:13	2025-10-28 13:54:07	ALLEGED
42668494	ACC097	IRS	RED KEEP	FIRELINK	JSCC	2025-01-11 05:55:00	2025-09-10 19:17:39	CLEARED
25246501	ACC010	CDS	RED KEEP	TRAI	CME	2025-04-03 14:02:02	2025-10-15 04:56:25	CLEARED
67536228	ACC073	CDS	WINTERFELL	TRAI	OTCCHK	2025-03-31 13:20:44	2025-08-21 04:08:50	CLEARED
36106022	ACC012	IRS	KINGSLANDING	MARC	OTCCHK	2025-07-15 21:46:58	2025-10-14 12:47:51	CLEARED
44289340	ACC048	CDS	HIGHGARDEN	MARC	JSCC	2025-02-05 03:38:42	2025-08-05 19:34:29	ALLEGED
98962729	ACC086	CDS	KINGSLANDING	BLM	JSCC	2025-06-03 15:20:25	2025-08-04 02:56:57	REJECTED
54580528	ACC029	FX	RED KEEP	FIRELINK	JSCC	2025-04-06 04:44:25	2025-08-28 05:57:33	ALLEGED
53850480	ACC094	CDS	KINGSLANDING	TRAI	LCH	2025-06-19 03:02:52	2025-09-23 01:10:04	REJECTED
89369810	ACC006	CDS	HIGHGARDEN	TRAI	LCH	2025-03-09 01:18:04	2025-09-19 07:54:10	REJECTED
99202386	ACC067	IRS	KINGSLANDING	MARC	CME	2025-06-03 09:18:07	2025-09-15 01:19:26	REJECTED
60494436	ACC066	FX	KINGSLANDING	TRAI	OTCCHK	2025-06-26 12:42:56	2025-10-31 15:34:00	CLEARED
30157884	ACC036	FX	KINGSLANDING	MARC	OTCCHK	2025-04-08 01:47:11	2025-09-03 00:02:47	CANCELLED
96565146	ACC017	CDS	RED KEEP	FIRELINK	JSCC	2025-07-06 18:04:10	2025-10-26 01:59:09	ALLEGED
26654809	ACC050	FX	HIGHGARDEN	FIRELINK	LCH	2025-02-12 08:58:36	2025-10-11 05:30:35	CANCELLED
21873774	ACC035	IRS	KINGSLANDING	TRAI	CME	2025-03-14 00:34:13	2025-09-20 06:25:11	CANCELLED
15149979	ACC008	CDS	WINTERFELL	BLM	LCH	2025-02-17 04:26:56	2025-10-12 22:59:18	CANCELLED
44994216	ACC096	FX	WINTERFELL	MARC	JSCC	2025-02-18 17:15:26	2025-10-24 10:23:28	ALLEGED
25399440	ACC028	IRS	RED KEEP	BLM	LCH	2025-03-14 17:49:34	2025-09-30 18:30:21	REJECTED
85631648	ACC020	FX	HIGHGARDEN	FIRELINK	OTCCHK	2025-05-28 01:23:25	2025-09-09 14:04:25	ALLEGED
87841659	ACC082	FX	RED KEEP	BLM	JSCC	2025-05-24 02:34:28	2025-10-07 23:22:55	CLEARED
72840839	ACC026	CDS	WINTERFELL	BLM	JSCC	2025-04-28 10:09:41	2025-09-26 16:06:00	ALLEGED
98860229	ACC063	CDS	HIGHGARDEN	BLM	OTCCHK	2025-04-14 17:29:48	2025-08-13 09:30:08	REJECTED
21309141	ACC014	FX	WINTERFELL	FIRELINK	OTCCHK	2025-05-22 03:41:42	2025-08-05 04:17:02	CLEARED
87666057	ACC025	IRS	HIGHGARDEN	FIRELINK	LCH	2025-06-06 06:06:41	2025-08-29 23:54:13	CLEARED
64238205	ACC004	IRS	HIGHGARDEN	FIRELINK	JSCC	2025-03-13 01:07:42	2025-09-17 11:46:48	CLEARED
43458153	ACC018	CDS	WINTERFELL	BLM	CME	2025-03-06 09:21:27	2025-10-29 02:45:41	CLEARED
82105744	ACC039	IRS	RED KEEP	FIRELINK	OTCCHK	2025-05-09 04:32:40	2025-09-11 21:51:14	REJECTED
29290419	ACC009	CDS	RED KEEP	BLM	OTCCHK	2025-01-13 00:51:39	2025-08-09 23:51:06	REJECTED
30461963	ACC079	IRS	HIGHGARDEN	MARC	CME	2025-06-13 07:55:00	2025-09-29 05:47:42	CANCELLED
49364118	ACC007	IRS	RED KEEP	TRAI	JSCC	2025-05-15 11:25:39	2025-10-15 11:55:55	CLEARED
50038309	ACC065	IRS	HIGHGARDEN	BLM	CME	2025-05-14 05:44:23	2025-09-07 06:49:54	CANCELLED
70712244	ACC037	FX	HIGHGARDEN	FIRELINK	JSCC	2025-03-25 15:58:54	2025-08-20 13:29:24	CANCELLED
17881089	ACC090	IRS	RED KEEP	FIRELINK	LCH	2025-05-25 05:24:37	2025-08-26 19:26:02	CANCELLED
35526057	ACC057	FX	RED KEEP	BLM	CME	2025-02-22 15:51:53	2025-09-12 03:33:17	ALLEGED
22322060	ACC100	FX	HIGHGARDEN	BLM	LCH	2025-05-19 22:33:39	2025-10-13 06:55:12	ALLEGED
35141556	ACC055	CDS	HIGHGARDEN	MARC	OTCCHK	2025-06-25 18:55:37	2025-09-05 03:02:05	REJECTED
51259775	ACC044	CDS	KINGSLANDING	FIRELINK	LCH	2025-01-04 13:40:01	2025-10-10 18:18:56	ALLEGED
64428173	ACC051	IRS	HIGHGARDEN	FIRELINK	OTCCHK	2025-07-11 23:31:34	2025-10-18 07:19:07	CLEARED
83728843	ACC068	IRS	KINGSLANDING	FIRELINK	OTCCHK	2025-07-08 13:03:08	2025-08-17 14:32:58	CLEARED
61389948	ACC047	FX	KINGSLANDING	FIRELINK	LCH	2025-05-12 01:17:40	2025-08-06 15:04:10	CANCELLED
88020567	ACC069	IRS	WINTERFELL	FIRELINK	CME	2025-07-26 00:04:43	2025-10-10 09:31:55	CLEARED
63209277	ACC062	CDS	RED KEEP	MARC	OTCCHK	2025-04-26 14:44:31	2025-08-08 13:42:26	REJECTED
25200175	ACC098	IRS	RED KEEP	BLM	JSCC	2025-07-07 16:37:08	2025-09-30 01:47:23	ALLEGED
48871459	ACC080	CDS	RED KEEP	BLM	CME	2025-06-28 20:29:29	2025-08-31 08:00:19	CLEARED
93739599	ACC042	FX	WINTERFELL	TRAI	JSCC	2025-03-15 23:26:56	2025-09-27 22:38:48	ALLEGED
51089450	ACC059	FX	RED KEEP	FIRELINK	OTCCHK	2025-04-19 23:28:52	2025-10-20 06:52:30	CANCELLED
29055274	ACC049	FX	KINGSLANDING	MARC	LCH	2025-02-06 18:23:08	2025-09-10 02:20:57	REJECTED
39461893	ACC099	IRS	WINTERFELL	FIRELINK	LCH	2025-07-19 20:30:19	2025-09-03 04:53:11	CLEARED
69661274	ACC058	CDS	HIGHGARDEN	TRAI	CME	2025-01-12 09:54:59	2025-08-10 12:08:34	REJECTED
37158077	ACC076	IRS	KINGSLANDING	TRAI	LCH	2025-01-28 22:43:30	2025-08-03 03:09:40	CLEARED
11380595	ACC033	FX	KINGSLANDING	TRAI	JSCC	2025-02-05 23:29:48	2025-10-04 15:06:51	ALLEGED
40745908	ACC095	FX	RED KEEP	FIRELINK	LCH	2025-05-26 06:23:19	2025-09-05 11:55:27	ALLEGED
81459852	ACC060	IRS	HIGHGARDEN	FIRELINK	CME	2025-07-16 05:53:38	2025-10-09 22:06:18	CLEARED
87072563	ACC064	CDS	WINTERFELL	FIRELINK	JSCC	2025-01-13 09:12:41	2025-10-30 11:03:22	CLEARED
50899479	ACC085	FX	WINTERFELL	TRAI	CME	2025-01-19 08:02:43	2025-08-17 03:43:01	CANCELLED
87339954	ACC038	IRS	RED KEEP	MARC	OTCCHK	2025-07-22 12:49:59	2025-09-16 04:29:34	CANCELLED
38302945	ACC030	CDS	WINTERFELL	BLM	OTCCHK	2025-01-04 14:59:29	2025-09-26 10:51:09	REJECTED
46902779	ACC002	FX	KINGSLANDING	MARC	CME	2025-07-10 06:53:24	2025-09-13 22:23:55	CLEARED
40547985	ACC053	CDS	WINTERFELL	TRAI	LCH	2025-05-05 03:22:24	2025-09-12 13:33:52	ALLEGED
63244917	ACC022	IRS	HIGHGARDEN	BLM	OTCCHK	2025-04-14 08:36:51	2025-08-13 11:18:12	REJECTED
66340127	ACC003	CDS	HIGHGARDEN	MARC	CME	2025-02-14 16:59:03	2025-10-08 05:29:29	REJECTED
73972538	ACC024	IRS	HIGHGARDEN	MARC	JSCC	2025-01-03 16:37:53	2025-08-28 11:38:12	CLEARED
36629187	ACC088	FX	WINTERFELL	MARC	CME	2025-07-12 12:52:04	2025-09-09 14:48:19	CLEARED
36349602	ACC092	FX	HIGHGARDEN	BLM	OTCCHK	2025-03-09 18:32:30	2025-08-19 00:51:22	CANCELLED
85373053	ACC075	IRS	WINTERFELL	MARC	JSCC	2025-03-15 06:02:15	2025-09-10 02:08:38	CANCELLED
76689540	ACC087	IRS	KINGSLANDING	MARC	JSCC	2025-01-30 23:12:55	2025-10-22 06:33:30	REJECTED
33154292	ACC083	FX	RED KEEP	MARC	OTCCHK	2025-07-11 20:33:47	2025-08-05 15:15:08	CANCELLED
97897651	ACC021	FX	KINGSLANDING	BLM	CME	2025-02-07 09:38:55	2025-10-16 16:04:08	REJECTED
92282247	ACC061	FX	WINTERFELL	TRAI	LCH	2025-05-20 09:15:28	2025-10-20 10:19:34	ALLEGED
54344649	ACC072	FX	RED KEEP	FIRELINK	CME	2025-04-24 13:47:38	2025-08-02 16:09:20	ALLEGED
73847580	ACC015	CDS	WINTERFELL	MARC	LCH	2025-06-06 21:03:05	2025-10-12 21:54:42	CANCELLED
37807798	ACC093	CDS	KINGSLANDING	BLM	OTCCHK	2025-06-01 22:00:50	2025-10-21 12:18:31	CLEARED
76369566	ACC052	FX	RED KEEP	TRAI	LCH	2025-07-12 14:54:36	2025-09-11 04:42:38	CANCELLED
"""

# Parse trades
trades = []
for line in trades_raw.strip().split('\n'):
    parts = line.split('\t')
    if len(parts) == 9:
        trades.append({
            'id': int(parts[0]),
            'account': parts[1],
            'asset_type': parts[2],
            'booking_system': parts[3],
            'affirmation_system': parts[4],
            'clearing_house': parts[5],
            'create_time': parts[6],
            'update_time': parts[7],
            'status': parts[8]
        })

# Randomize dates between 2024-01-01 and 2026-02-03
random.seed(42)  # For reproducibility
start_date = datetime(2024, 1, 1)
end_date = datetime(2026, 2, 3)
date_range = (end_date - start_date).days

for trade in trades:
    # Create time: random date in range
    create_offset = random.randint(0, date_range)
    create_dt = start_date + timedelta(days=create_offset)
    
    # Update time: 30-300 days after create time, but not exceeding end_date
    update_offset = random.randint(30, 300)
    update_dt = min(create_dt + timedelta(days=update_offset), end_date)
    
    trade['create_time'] = create_dt.strftime('%Y-%m-%d %H:%M:%S')
    trade['update_time'] = update_dt.strftime('%Y-%m-%d %H:%M:%S')

# Generate SQL
sql = """-- 100 trades with corrected spelling (FIRELINK) and randomized dates (2024-2026)
-- Synced between frontend and backend for consistent testing

INSERT INTO trades
  (id, account, asset_type, booking_system, affirmation_system, clearing_house, create_time, update_time, status)
VALUES
"""

values = []
for t in trades:
    values.append(
        f"({t['id']}, '{t['account']}', '{t['asset_type']}', '{t['booking_system']}', "
        f"'{t['affirmation_system']}', '{t['clearing_house']}', '{t['create_time']}', "
        f"'{t['update_time']}', '{t['status']}')"
    )

sql += ",\n".join(values) + ";\n\n"

# Add query history
sql += """-- Sample query history for demo user
INSERT INTO query_history (user_id, query_text, is_saved, query_name, create_time, last_use_time) VALUES
('demo_user', 'show me alleged CDS trades', TRUE, 'Alleged CDS Review', '2025-10-15 10:00:00', '2025-10-20 09:00:00'),
('demo_user', 'cleared IRS trades from last quarter', TRUE, 'Quarterly IRS', '2025-09-01 14:30:00', '2025-10-10 11:15:00'),
('demo_user', 'rejected trades in WINTERFELL', FALSE, NULL, '2025-10-22 16:45:00', '2025-10-22 16:45:00');
"""

print(sql)

# Also print TypeScript array for frontend
print("\n\n// ===== TypeScript for Frontend =====\n")
print("export const mockTrades: Trade[] = [")
for i, t in enumerate(trades):
    comma = "," if i < len(trades) - 1 else ""
    print(f"  {{")
    print(f"    trade_id: {t['id']},")
    print(f"    account: '{t['account']}',")
    print(f"    asset_type: '{t['asset_type']}',")
    print(f"    booking_system: '{t['booking_system']}',")
    print(f"    affirmation_system: '{t['affirmation_system']}',")
    print(f"    clearing_house: '{t['clearing_house']}',")
    print(f"    create_time: '{t['create_time']}',")
    print(f"    update_time: '{t['update_time']}',")
    print(f"    status: '{t['status']}',")
    print(f"  }}{comma}")
print("];")
